# üé® Supercharged Figma Integration

The DesignAssets package now includes a powerful Figma integration that can automatically fetch **ALL** icons from any Figma file and generate organized Swift code and Xcode asset catalogs.

## ‚ú® Features

- **üîç Comprehensive Discovery**: Automatically finds all icon components and instances in your Figma file
- **üìÇ Smart Organization**: Groups icons by categories (General, Map, Status, Navigation, Social)
- **üé® Variant Support**: Handles filled, outline, light, and dark variants
- **üì¶ Asset Catalog Generation**: Creates proper Xcode `.xcassets` files with `Contents.json`
- **‚ö° Swift Code Generation**: Generates organized Swift enums for type-safe icon access
- **üìä Detailed Reporting**: Creates summary reports of all fetched icons
- **üöÄ Batch Processing**: Downloads icons efficiently with rate limiting
- **üõ†Ô∏è Flexible Configuration**: Customizable options for different use cases

## üöÄ Quick Start

### 1. Get Your Figma Access Token

1. Go to [Figma Settings](https://www.figma.com/settings)
2. Navigate to **Account** ‚Üí **Personal Access Tokens**
3. Click **Create new token**
4. Give it a name and copy the token

### 2. Extract File ID from Figma URL

From a Figma URL like:
```
https://www.figma.com/design/T0ahWzB1fWx5BojSMkfiAE/Icons?node-id=0-1&p=f&t=hOWJQCi2xHN1vG4G-0
```

The file ID is: `T0ahWzB1fWx5BojSMkfiAE`

### 3. Run the Plugin

```bash
# Using command line arguments
swift package plugin fetch-icons --token YOUR_TOKEN --file-id T0ahWzB1fWx5BojSMkfiAE

# Using environment variables
export FIGMA_PERSONAL_TOKEN="your_token_here"
export FIGMA_FILE_ID="T0ahWzB1fWx5BojSMkfiAE"
swift package plugin fetch-icons
```

## üìã Command Line Options

```bash
swift package plugin fetch-icons [options]

Options:
  --token <token>        Figma personal access token
  --file-id <file-id>    Figma file ID to fetch icons from
  --no-variants          Skip variant processing (filled/outline)
  --no-asset-catalog     Skip Xcode asset catalog generation
  --no-swift-code        Skip Swift code generation
  --help, -h             Show help message

Environment Variables:
  FIGMA_PERSONAL_TOKEN   Figma personal access token
  FIGMA_FILE_ID          Figma file ID
```

## üìÅ Generated Structure

The plugin creates a well-organized structure:

```
Sources/DesignAssets/Resources/
‚îú‚îÄ‚îÄ Icons.xcassets/                    # Xcode Asset Catalog
‚îÇ   ‚îú‚îÄ‚îÄ Contents.json
‚îÇ   ‚îú‚îÄ‚îÄ icon_name_1.imageset/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Contents.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ icon_name_1.png
‚îÇ   ‚îî‚îÄ‚îÄ icon_name_2.imageset/
‚îÇ       ‚îú‚îÄ‚îÄ Contents.json
‚îÇ       ‚îî‚îÄ‚îÄ icon_name_2.png
‚îú‚îÄ‚îÄ GeneratedIcons.swift               # Generated Swift Code
‚îî‚îÄ‚îÄ icon-summary.md                    # Summary Report
```

## üéØ Generated Swift Code

The plugin generates organized Swift code with categories:

```swift
// Generated by DesignAssets Figma Integration
public struct GeneratedIcons {
    public static let bundle = Bundle.module
    
    @available(iOS 13.0, macOS 10.15, *)
    public static func icon(named name: String) -> Image? {
        return Image(name, bundle: bundle)
    }
}

// Icon Categories
public extension GeneratedIcons {
    enum General: String, CaseIterable {
        case home_icon = "home_icon"
        case search_icon = "search_icon"
        case settings_icon = "settings_icon"
        // ... more icons
        
        @available(iOS 13.0, macOS 10.15, *)
        public var image: Image? {
            return GeneratedIcons.icon(named: self.rawValue)
        }
    }
    
    enum Map: String, CaseIterable {
        case location_pin = "location_pin"
        case map_marker = "map_marker"
        // ... more icons
    }
    
    enum Status: String, CaseIterable {
        case success_icon = "success_icon"
        case error_icon = "error_icon"
        // ... more icons
    }
    
    // Master enum with all icons
    enum All: String, CaseIterable {
        case home_icon = "home_icon"
        case search_icon = "search_icon"
        // ... all icons
        
        public var category: String {
            switch self {
            case .home_icon, .search_icon:
                return "General"
            case .location_pin:
                return "Map"
            // ... category mapping
            }
        }
    }
}
```

## üí° Usage Examples

### SwiftUI

```swift
import SwiftUI
import DesignAssets

struct MyView: View {
    var body: some View {
        VStack {
            // Using category-specific icons
            GeneratedIcons.General.home_icon.image
            GeneratedIcons.Map.location_pin.image
            GeneratedIcons.Status.success_icon.image
            
            // Using the master enum
            GeneratedIcons.All.home_icon.image
            
            // Dynamic icon loading
            ForEach(GeneratedIcons.General.allCases, id: \.self) { icon in
                icon.image
            }
        }
    }
}
```

### UIKit

```swift
import UIKit
import DesignAssets

class MyViewController: UIViewController {
    override func viewDidLoad() {
        super.viewDidLoad()
        
        let imageView = UIImageView()
        if let image = GeneratedIcons.General.home_icon.uiImage as? UIImage {
            imageView.image = image
        }
    }
}
```

## üîß Advanced Configuration

### Custom Icon Discovery

The plugin automatically discovers icons by looking for:

- **Component names** containing: `icon`, `ic_`, `ui_`, `nav_`, `status_`, `map_`
- **Instance names** with icon patterns
- **File structure** analysis

### Category Detection

Icons are automatically categorized based on naming patterns:

- **Map**: `map`, `location`, `pin`
- **Status**: `status`, `notification`, `alert`
- **Navigation**: `nav`, `navigation`, `ui`
- **Social**: `social`, `facebook`, `twitter`
- **General**: Everything else

### Variant Detection

The plugin detects variants from naming:

- **Filled**: `filled`, `solid`
- **Outline**: `outline`, `stroke`, `line`
- **Light**: `light`
- **Dark**: `dark`

## üìä Summary Report

The plugin generates a detailed summary report (`icon-summary.md`):

```markdown
# Figma Icons Summary Report

Generated on: 2024-01-15 10:30:00 +0000
Total Icons: 156

## Categories
- **General**: 89 icons
- **Map**: 12 icons
- **Status**: 23 icons
- **Navigation**: 32 icons

## Variants
- **filled**: 78 icons
- **outline**: 78 icons

## All Icons
- `home_icon` (General, filled)
- `home_icon_outline` (General, outline)
- `location_pin` (Map, filled)
- ...
```

## üö® Troubleshooting

### Common Issues

1. **"FIGMA_PERSONAL_TOKEN not set"**
   - Make sure you've set the token in environment variables or passed it via `--token`

2. **"Failed to fetch Figma file"**
   - Check that your token has access to the file
   - Verify the file ID is correct
   - Ensure the file is not private or requires special permissions

3. **"No icons found"**
   - Check that your Figma file contains components or instances with icon-like names
   - Try using more generic naming patterns like `icon_*` or `ic_*`

4. **Rate limiting errors**
   - The plugin includes built-in rate limiting, but very large files might still hit limits
   - Try running the plugin again after a short delay

### Debug Mode

For detailed logging, you can check the plugin output in Xcode or terminal. The plugin provides comprehensive logging of:

- File discovery progress
- Icon categorization
- Download progress
- Error details

## üîÑ Workflow Integration

### CI/CD Integration

```yaml
# GitHub Actions example
- name: Fetch Icons from Figma
  run: |
    export FIGMA_PERSONAL_TOKEN="${{ secrets.FIGMA_TOKEN }}"
    export FIGMA_FILE_ID="${{ secrets.FIGMA_FILE_ID }}"
    swift package plugin fetch-icons
```

### Design System Updates

1. Update icons in Figma
2. Run the plugin to fetch latest icons
3. Commit the generated files
4. Update your app to use new icons

## üé® Best Practices

### Figma File Organization

- Use consistent naming conventions: `icon_category_variant`
- Group related icons in frames or components
- Use descriptive names that indicate the icon's purpose
- Consider using Figma's component properties for variants

### Swift Code Organization

- Use the generated category enums for better organization
- Leverage the `All` enum for dynamic icon loading
- Use the `category` property for filtering and grouping

### Asset Management

- The generated asset catalog follows Xcode best practices
- Icons are automatically optimized for different scales
- Use the generated Swift code for type-safe icon access

## ü§ù Contributing

Found an issue or have a feature request? Please open an issue or submit a pull request!

## üìÑ License

This project is licensed under the MIT License - see the LICENSE file for details.
